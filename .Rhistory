library(tidyverse)
library(installr)
library(dplyr)
library(ggplot2)
library(haven)
library(MASS)
library(foreign)
#데이터셋을 함수에 할당
da_2013 <- read.csv("F:/경진대회/데이터/2013.csv")
da_2014 <- read.csv("F:/경진대회/데이터/2014.csv")
da_2015 <- read.csv("F:/경진대회/데이터/2015.csv")
da_2016 <- read.csv("F:/경진대회/데이터/2016.csv")
da_2017 <- read.csv("F:/경진대회/데이터/2017.csv")
da_2018 <- read.csv("F:/경진대회/데이터/2018.csv")
da_2019 <- read.csv("F:/경진대회/데이터/2019.csv")
summary(da_2013$출생년도)
da_2013$출생년도 <- ifelse(da_2013$출생년도<1963, NA, da_2013$출생년도)
summary(da_2013$활동상태)
da_2013$활동상태 <- ifelse(da_2013$활동상태>6, NA, da_2013$활동상태)
summary(da_2014$출생년도)
da_2014$출생년도 <- ifelse(da_2014$출생년도<1963, NA, da_2014$출생년도)
summary(da_2013$활동상태)
da_2014$활동상태 <- ifelse(da_2014$활동상태>6, NA, da_2014$활동상태)
da_2016$출생년도 <- ifelse(da_2016$출생년도<1954, NA, da_2016$출생년도)
da_2017$출생년도 <- ifelse(da_2017$출생년도<1954, NA, da_2017$출생년도)
#할당됐는지 확인
View(da_2013)
#연도별 성별에 따른 취업여부
sex_job <- da_2013 %>%
group_by(성별) %>%
select(취업여부)
#연도별 성별에 따른 취업여부
sex_job <- da_2013 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job
#연도별 성별에 따른 취업여부
sex_job_13 <- da_2013 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_13
sex_job_14 <- da_2014 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_14
sex_job_15 <- da_2015 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_15
sex_job_16 <- da_2016 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_16
sex_job_17 <- da_2017 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_17
sex_job_18 <- da_2018 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_18
sex_job_19 <- da_2019 %>%
group_b(취업여부, 성별) %>%
summarise(n=n())
sex_job_19
sex_job_19 <- da_2019 %>%
group_by(취업여부, 성별) %>%
summarise(n=n())
sex_job_19
#노인 및 청년인구 취업여부
summary(da_2013$출생년도, is.na(da_2013$출생년도)=T)
#노인 및 청년인구 취업여부
summary(da_2013$출생년도)
da_2013$출생년도 <- 2013 - da_2013$출생년도+1
#노인 및 청년인구 취업여부
summary(da_2013$출생년도)
da_2014$출생년도 <- 2014 - da_2014$출생년도+1
da_2015$출생년도 <- 2015 - da_2015$출생년도+1
da_2016$출생년도 <- 2016 - da_2016$출생년도+1
da_2017$출생년도 <- 2017 - da_2017$출생년도+1
da_2018$출생년도 <- 2018 - da_2018$출생년도+1
da_2019$출생년도 <- 2019 - da_2019$출생년도+1
summary(da_2014$출생년도)
summary(da_2015$출생년도)
summary(da_2016$출생년도)
summary(da_2017$출생년도)
summary(da_2018$출생년도)
summary(da_2019$출생년도)
summary(da_2013$출생년도)
summary(da_2014$출생년도)
summary(da_2015$출생년도)
summary(da_2016$출생년도)
summary(da_2017$출생년도)
summary(da_2018$출생년도)
summary(da_2019$출생년도)
#연령별로 분류(30세 미만 초년, 30~59세 중년 외 노년)
ages_13 <- da_2013 %>%
mutate(ageg_13 = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
ages_13
#연령별로 분류(30세 미만 초년, 30~59세 중년 외 노년)
da_2013 <- da_2013 %>%
mutate(ageg_13 = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
#연령별로 분류(30세 미만 초년, 30~59세 중년 외 노년)
da_2013 <- da_2013 %>%
mutate(ages_13 = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
table(da_2013$ages_13)
summary(da_2013$출생년도)
table(da_2013$ages_13)
da_2014 <- da_2014 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
table(da_2013$ages)
table(da_2014$ages)
da_2015 <- da_2015 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
table(da_2015$ages)
da_2016 <- da_2016 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
table(da_2016$ages)
da_2017 <- da_2017 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
da_2018 <- da_2018 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
da_2019 <- da_2019 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
table(da_2017$ages)
table(da_2018$ages)
table(da_2019$ages)
#연령별 취업여부
agjob_13 <- da_2013 %>%
filter(!is.na(da_2013$출생년도)) %>%
group_by(ages, 취업여부) %>%
summarise(n=n())
#연령별로 분류(30세 미만 초년, 30~59세 중년 외 노년)
da_2013 <- da_2013 %>%
mutate(ages = ifelse(출생년도 < 30, "young",
ifelse(출생년도 <= 59, "middle", "old")))
table(da_2013$ages)
#연령별 취업여부
agjob_13 <- da_2013 %>%
filter(!is.na(da_2013$출생년도)) %>%
group_by(ages, 취업여부) %>%
summarise(n=n())
agjob_13
boxplot(da_2018$취업여부)
boxplot(da_2018$취업여부)
boxplot(da_2013$취업여부)
da_2013$취업여부 <- ifelse(da_2013$취업여부==0, NA, da_2013$취업여부)
da_2014$취업여부 <- ifelse(da_2014$취업여부==0, NA, da_2014$취업여부)
da_2015$활동상태 <- ifelse(da_2015$활동상태>6, NA, da_2015$활동상태)
da_2015$취업여부 <- ifelse(da_2015$취업여부==0, NA, da_2015$취업여부)
da_2016$취업여부 <- ifelse(da_2016$취업여부==0, NA, da_2016$취업여부)
da_2017$취업여부 <- ifelse(da_2017$취업여부==0, NA, da_2017$취업여부)
#2018 결측치 처리
da_2018$취업여부 <- ifelse(da_2018$취업여부==0, NA, da_2018$취업여부)
#2019 결축치 처리
da_2019$취업여부 <- ifelse(da_2019$취업여부==0, NA, da_2019$취업여부)
#취업여부 데이터 변환
da_2013$취업여부 <- ifelse(1=="did",
ifelse(2=="nopay", "didnt"))
#취업여부 데이터 변환
da_2013$취업여부 <- da_2013 %>%
ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt"))
#취업여부 데이터 변환
da_2013 <- da_2013 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
da_2014 <- da_2014 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
da_2015 <- da_2015 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
da_2016 <- da_2016 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
da_2017 <- da_2017 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
da_2018 <- da_2018 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
da_2019 <- da_2019 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
#연도별 성별에 따른 취업여부
sex_job_13 <- da_2013 %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_13
#연도별 성별에 따른 취업여부
sex_job_13 <- da_2013 %>%
filter(!is.na(gjob))
sex_job_13
group_by(gjob, 성별) %>%
summarise(n=n())
#취업여부 데이터 변환
da_2013 <- da_2013 %>%
mutate(gjob = ifelse(취업여부==1, "did",
ifelse(취업여부==2, "nopay", "didnt")))
#연도별 성별에 따른 취업여부
sex_job_13 <- da_2013 %>%
filter(!is.na(gjob))
sex_job_13
#연도별 성별에 따른 취업여부
sex_job_13 <- da_2013 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_13
sex_job_14 <- da_2014 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_14
sex_job_15 <- da_2015 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_15
sex_job_16 <- da_2016 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_17 <- da_2017 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_18 <- da_2018 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
sex_job_18
sex_job_19 <- da_2019 %>%
filter(!is.na(gjob)) %>%
group_by(gjob, 성별) %>%
summarise(n=n())
#연령별 취업여부
agjob_13 <- da_2013 %>%
filter(!is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_13
#연령별 취업여부
agjob_13 <- da_2013 %>%
filter(!is.na(gjob & ages)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
#연령별 취업여부
agjob_13 <- da_2013 %>%
filter(!is.na(gjob) & !is.na(ages)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_13
#연령별 취업여부
agjob_13 <- da_2013 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_13
agjob_14 <- da_2014 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_14
agjob_15 <- da_2015 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_15
agjob_16 <- da_2016 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_16
agjob_17 <- da_2017 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_17
agjob_18
agjob_18 <- da_2018 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_18
agjob_19
agjob_19 <- da_2019 %>%
filter(!is.na(ages) & !is.na(gjob)) %>%
group_by(ages, gjob) %>%
summarise(n=n())
agjob_19
